# How-to: ルートの .md ファイルへアクセスする自動更新型 index.html を置く方法

ジャンル・カテゴリ: ハウツー
[[#概要]]
[[#目標]]
[[#必要なもの]]
[[#index.html のコード（コピーして使えます）]]
[[#使い方と説明]]
[[#デプロイ手順（GitHub に置く場合）]]
[[#補足 — 足りない手順や注意点]]
[[#よくある質問（FAQ）]]
[[#まとめ]]

## 概要
このガイドは、リポジトリのルートに **置くだけで** 現在のルート直下にあるすべての `.md` ファイルを自動的に列挙してリンク表示する `index.html` を作る方法を解説します。将来 `.md` が増えても自動で反映されます（GitHub の Contents API を利用）。

## 目標
- ルート直下の `.md` ファイルを動的に一覧表示する `index.html` を用意する。
- 新規 `.md` の追加・削除があってもページを編集せず反映される仕組みにする。
- GitHub 上でそのまま使える（公開ページ化は別途 GitHub Pages の設定が必要）。

## 必要なもの
- 公開リポジトリ（例: `YaMac33/obsidian`）。今回の対象は公開リポジトリです。
- ブラウザで動く単一ファイル（`index.html`）。サーバサイドは不要。
- （任意）GitHub Pages を使ってウェブとして公開する場合は Pages の設定。

## index.html のコード（コピーして使えます）
- 以下を `index.html` としてリポジトリのルートに置いてください。
- 公開リポジトリであれば認証なしで閲覧できます（API レート制限に注意）。

```
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Index of Markdown files</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Hiragino Kaku Gothic ProN",sans-serif;margin:24px}
    h1{margin-bottom:0.2em}
    ul{padding-left:1rem}
    li{margin:0.4rem 0}
    .meta{color:#666;font-size:0.9rem}
    .notice{margin-top:1rem;color:#b33}
  </style>
</head>
<body>
  <h1>Markdown ファイル一覧</h1>
  <p class="meta">リポジトリのルート直下にある .md ファイルを自動で列挙します。</p>
  <div id="list">読み込み中…</div>
  <p class="notice" id="notice"></p>
<script>
(async function(){
  const owner = 'YaMac33';
  const repo = 'obsidian';
  const branch = 'main';
  const api = `https://api.github.com/repos/${owner}/${repo}/contents?ref=${branch}`;

  try {
    const res = await fetch(api);
    if (!res.ok) throw new Error('GitHub API エラー: ' + res.status);
    const items = await res.json();
    const md = items.filter(it => it.type === 'file' && it.name.toLowerCase().endsWith('.md'));
    const container = document.getElementById('list');
    if (md.length === 0) {
      container.innerHTML = '<p>ルートに .md ファイルが見つかりません。</p>';
      return;
    }
    const ul = document.createElement('ul');
    // ソート（名前順・日付順にしたければ API の commit 情報を別途取得）
    md.sort((a,b)=>a.name.localeCompare(b.name, undefined, {numeric:true}));
    md.forEach(file => {
      const li = document.createElement('li');
      // GitHub 上でレンダリングされたページに飛ばす（html_url を使用）
      const a = document.createElement('a');
      a.href = file.html_url;
      a.textContent = file.name;
      a.target = '_blank';
      a.rel = 'noopener noreferrer';
      li.appendChild(a);
      // optional: ダウンロードURLや raw へのリンク
      const meta = document.createElement('div');
      meta.className = 'meta';
      meta.textContent = `サイズ: ${file.size} bytes`;
      li.appendChild(meta);
      ul.appendChild(li);
    });
    container.innerHTML = '';
    container.appendChild(ul);
    // 注意: GitHub API の未認証レート制限は 60 req/hour
    document.getElementById('notice').textContent = '';
  } catch (err) {
    document.getElementById('list').innerHTML = '<p>一覧の取得に失敗しました。</p>';
    document.getElementById('notice').textContent = err.message + ' — API レート制限やネットワークを確認してください。';
  }
})();
</script>
</body>
</html>
```

## 使い方と説明
- index.html はクライアントサイド JS で GitHub REST API (/repos/:owner/:repo/contents) を叩いてルート直下のファイル一覧を取得します。
- .md のフィルタリングは name.endsWith('.md') で行っています（大文字小文字対応済）。
- 各エントリは GitHub の html_url にリンクします → GitHub 上で Markdown がレンダリングされたページへ飛びます。
- 新しい .md を追加すると（push すると）API が返す一覧に反映されるため、次回ページを読み込めば自動で反映されます。

## デプロイ手順（GitHub に置く場合
- リポジトリのルートに index.html を追加してコミット・プッシュするだけで OK（公開リポジトリであること）。
- ウェブで直接公開したい場合は GitHub Pages を有効化（リポジトリ > Settings > Pages > branch を main、root を選択）。
- Pages を使うと https://<user>.github.io/<repo>/ で index.html が表示されます（反映に数分かかる場合あり）

## 補足 — 足りない手順や注意点
- API レート制限: 未認証の API は 60 リクエスト/時 の制限があります。大量アクセスや頻繁な自動読み込みが必要なら：  
- サーバ側で一度だけ取得して静的 index.html を生成（CI で更新）する方法を推奨。
- または、アクセストークンを使うことでレート上限を上げられますが、クライアントにトークンを含めるのはセキュリティ的に NG。サーバ経由でのプロキシを検討してください。
- サブフォルダの md: 上のスクリプトはルート直下のみを対象です。サブフォルダも含めたい場合は、API で再帰的にフォルダを巡回する実装（/git/trees API の recursive=1）が必要です。
- ローカルでの参照: ローカルで file:// から開くと fetch がブロックされることがあります（CORS/ブラウザ制約）。GitHub に上げて URL で開いて確認してください。
- 代替案（静的生成）: CI（GitHub Actions）で index.md を自動生成→コミットするワークフローにすると、API を叩かず確実に表示できます。必要なら Actions のサンプルを追記します。

## よくある質問（FAQ）
- Q: 「raw（生データ）ではなくレンダリング済ページに飛ばしたい」  
    A: 既存コードは file.html_url（GitHub の blob ページ）を使うためそのままで OK。raw が良ければ download_url を使ってください。
- Q: 「サブフォルダ内の md も一覧に入れたい」  
    A: git/trees?recursive=1 を使うか、フォルダ毎に API を呼び出す実装に変更してください（補助コード提供可）。
- Q: 「プライベートリポジトリで使える？」  
    A: クライアント側にトークンを埋めるのは非推奨。プライベートの場合はサーバ経由でトークン管理するか、CI で静的 index を生成してコミットする方法が安全です。

## まとめ
- 上の index.html をルートに置けば、リポジトリ直下の .md が自動で一覧化されます。将来の追加も反映され、手軽に目次ページが作れます。
- ただし公開利用時は GitHub API のレート制限やプライベートリポジトリでの認証方法に注意してください。必要なら CI で静的生成するワークフローを推奨します。

---

※この記事はAIの回答を基に作成しています。
